Creating local yum repo mirrors
===============================

yum install yum-utils createrepo -y

CentOS mirror

cd /var/www/kam

cat << EOF > sync-centos.sh
#!/bin/sh
#
# reposync
#

BASEDIR=/var/www/kam/centos/7
mkdir -p \$BASEDIR
cd \$BASEDIR

reposync -n -r updates
repomanage -o -c updates | xargs rm -fv
createrepo updates

reposync -n -r base --downloadcomps
repomanage -o -c base | xargs rm -fv
createrepo base -g comps.xml
EOF

chmod 755 sync-centos.sh
sh sync-centos.sh

EPEL mirror
===========

rpm -ivh http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-8.noarch.rpm
cd /var/www/kam

cat << EOF > sync-epel.sh
#!/bin/sh
#
# reposync
#

BASEDIR=/var/www/kam/centos/7
mkdir -p \$BASEDIR
cd \$BASEDIR

reposync -n -r epel
repomanage -o -c epel | xargs rm -fv
createrepo epel
EOF

chmod 755 sync-epel.sh
sh sync-epel.sh

EPEL mirror
===========

rpm -Uvh https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm
cd /var/www/kam

cat << EOF > sync-puppet.sh
#!/bin/sh
#
# reposync
#

BASEDIR=/var/www/kam/centos/7
mkdir -p \$BASEDIR
cd \$BASEDIR

reposync -n -r puppet
repomanage -o -c puppet | xargs rm -fv
createrepo puppet
EOF

chmod 755 sync-puppet.sh
sh sync-puppet.sh

Update all Cron
===============

* * * * * cd /var/www/kam; sh $(ls | grep sync)
