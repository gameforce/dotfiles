Creating local yum repo mirrors
===============================

yum install yum-utils createrepo -y

CentOS mirror

cd /var/www/html

cat << EOF > sync-centos.sh
#!/bin/sh
#
# reposync
#

BASEDIR=/var/www/html/centos/7
mkdir -p \$BASEDIR
cd \$BASEDIR

reposync -n -r updates
repomanage -o -c updates | xargs rm -fv
createrepo updates

reposync -n -r base --downloadcomps
repomanage -o -c base | xargs rm -fv
createrepo base -g comps.xml
EOF

chmod 755 sync-centos.sh
sh sync-centos.sh

EPEL mirror
===========

# Download the rpm
rpm -ivh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
cd /var/www/html

cat << EOF > sync-epel.sh
#!/bin/sh
#
# reposync
#

BASEDIR=/var/www/html/centos/7
mkdir -p \$BASEDIR
cd \$BASEDIR

reposync -n -r epel
repomanage -o -c epel | xargs rm -fv
createrepo epel
EOF

chmod 755 sync-epel.sh
sh sync-epel.sh

PUPPET Mirror
=============

# Download the rpm
rpm -Uvh  https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm
# Edit the yum repo file name to puppet (from puppet-pc1)

cat << EOF > sync-puppet.sh
#!/bin/sh
#
# reposync
#

BASEDIR=/var/www/html/centos/7
mkdir -p \$BASEDIR
cd \$BASEDIR

reposync -n -r epel
repomanage -o -c puppet | xargs rm -fv
createrepo puppet
EOF

chmod 755 sync-puppet.sh
sh sync-puppet.sh

Update all
==========

cd /var/www/html
for i in ls | grep sync; do sh $i; done
